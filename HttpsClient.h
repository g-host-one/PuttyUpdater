#include <boost/asio.hpp>
#include <boost/bind.hpp>
#include <boost/asio/ssl.hpp>
#include <boost/algorithm/string.hpp>

class HttpsClient
{
public:
	HttpsClient();
	~HttpsClient();

	void open(std::string host, std::string path);
	unsigned int get_status_code() { return status_code; }
	std::string get_status_message() { return status_message; }
	std::string get_body() { return body.str();  }
	std::string get_header(std::string key) { return headers[key]; }
	std::map<std::string, std::string> get_headers() { return headers; }

private:
	boost::asio::ssl::context *ctx;
	boost::asio::io_service *io_service;
	std::string host;
	std::string path;
	unsigned int status_code;
	std::string status_message;
	std::map<std::string, std::string> headers;
	std::stringstream body;

	const std::string ca = { 45, 45, 45, 45, 45, 66, 69, 71, 73, 78, 32, 67, 69, 82, 84, 73, 70, 73, 67, 65, 84, 69, 45, 45, 45, 45, 45, 10, 77, 73, 73, 68, 83, 106, 67, 67, 65, 106, 75, 103, 65, 119, 73, 66, 65, 103, 73, 81, 82, 75, 43, 119, 103, 78, 97, 106, 74, 55, 113, 74, 77, 68, 109, 71, 76, 118, 104, 65, 97, 122, 65, 78, 66, 103, 107, 113, 104, 107, 105, 71, 57, 119, 48, 66, 65, 81, 85, 70, 65, 68, 65, 47, 10, 77, 83, 81, 119, 73, 103, 89, 68, 86, 81, 81, 75, 69, 120, 116, 69, 97, 87, 100, 112, 100, 71, 70, 115, 73, 70, 78, 112, 90, 50, 53, 104, 100, 72, 86, 121, 90, 83, 66, 85, 99, 110, 86, 122, 100, 67, 66, 68, 98, 121, 52, 120, 70, 122, 65, 86, 66, 103, 78, 86, 66, 65, 77, 84, 10, 68, 107, 82, 84, 86, 67, 66, 83, 98, 50, 57, 48, 73, 69, 78, 66, 73, 70, 103, 122, 77, 66, 52, 88, 68, 84, 65, 119, 77, 68, 107, 122, 77, 68, 73, 120, 77, 84, 73, 120, 79, 86, 111, 88, 68, 84, 73, 120, 77, 68, 107, 122, 77, 68, 69, 48, 77, 68, 69, 120, 78, 86, 111, 119, 10, 80, 122, 69, 107, 77, 67, 73, 71, 65, 49, 85, 69, 67, 104, 77, 98, 82, 71, 108, 110, 97, 88, 82, 104, 98, 67, 66, 84, 97, 87, 100, 117, 89, 88, 82, 49, 99, 109, 85, 103, 86, 72, 74, 49, 99, 51, 81, 103, 81, 50, 56, 117, 77, 82, 99, 119, 70, 81, 89, 68, 86, 81, 81, 68, 10, 69, 119, 53, 69, 85, 49, 81, 103, 85, 109, 57, 118, 100, 67, 66, 68, 81, 83, 66, 89, 77, 122, 67, 67, 65, 83, 73, 119, 68, 81, 89, 74, 75, 111, 90, 73, 104, 118, 99, 78, 65, 81, 69, 66, 66, 81, 65, 68, 103, 103, 69, 80, 65, 68, 67, 67, 65, 81, 111, 67, 103, 103, 69, 66, 10, 65, 78, 43, 118, 54, 90, 100, 81, 67, 73, 78, 88, 116, 77, 120, 105, 90, 102, 97, 81, 103, 117, 122, 72, 48, 121, 120, 114, 77, 77, 112, 98, 55, 78, 110, 68, 102, 99, 100, 65, 119, 82, 103, 85, 105, 43, 68, 111, 77, 51, 90, 74, 75, 117, 77, 47, 73, 85, 109, 84, 114, 69, 52, 79, 10, 114, 122, 53, 73, 121, 50, 88, 117, 47, 78, 77, 104, 68, 50, 88, 83, 75, 116, 107, 121, 106, 52, 122, 108, 57, 51, 101, 119, 69, 110, 117, 49, 108, 99, 67, 74, 111, 54, 109, 54, 55, 88, 77, 117, 101, 103, 119, 71, 77, 111, 79, 105, 102, 111, 111, 85, 77, 77, 48, 82, 111, 79, 69, 113, 10, 79, 76, 108, 53, 67, 106, 72, 57, 85, 76, 50, 65, 90, 100, 43, 51, 85, 87, 79, 68, 121, 79, 75, 73, 89, 101, 112, 76, 89, 89, 72, 115, 85, 109, 117, 53, 111, 117, 74, 76, 71, 105, 105, 102, 83, 75, 79, 101, 68, 78, 111, 74, 106, 106, 52, 88, 76, 104, 55, 100, 73, 78, 57, 98, 10, 120, 105, 113, 75, 113, 121, 54, 57, 99, 75, 51, 70, 67, 120, 111, 108, 107, 72, 82, 121, 120, 88, 116, 113, 113, 122, 84, 87, 77, 73, 110, 47, 53, 87, 103, 84, 101, 49, 81, 76, 121, 78, 97, 117, 55, 70, 113, 99, 107, 104, 52, 57, 90, 76, 79, 77, 120, 116, 43, 47, 121, 85, 70, 119, 10, 55, 66, 90, 121, 49, 83, 98, 115, 79, 70, 85, 53, 81, 57, 68, 56, 47, 82, 104, 99, 81, 80, 71, 88, 54, 57, 87, 97, 109, 52, 48, 100, 117, 116, 111, 108, 117, 99, 98, 89, 51, 56, 69, 86, 65, 106, 113, 114, 50, 109, 55, 120, 80, 105, 55, 49, 88, 65, 105, 99, 80, 78, 97, 68, 10, 97, 101, 81, 81, 109, 120, 107, 113, 116, 105, 108, 88, 52, 43, 85, 57, 109, 53, 47, 119, 65, 108, 48, 67, 65, 119, 69, 65, 65, 97, 78, 67, 77, 69, 65, 119, 68, 119, 89, 68, 86, 82, 48, 84, 65, 81, 72, 47, 66, 65, 85, 119, 65, 119, 69, 66, 47, 122, 65, 79, 66, 103, 78, 86, 10, 72, 81, 56, 66, 65, 102, 56, 69, 66, 65, 77, 67, 65, 81, 89, 119, 72, 81, 89, 68, 86, 82, 48, 79, 66, 66, 89, 69, 70, 77, 83, 110, 115, 97, 82, 55, 76, 72, 72, 54, 50, 43, 70, 76, 107, 72, 88, 47, 120, 66, 86, 103, 104, 89, 107, 81, 77, 65, 48, 71, 67, 83, 113, 71, 10, 83, 73, 98, 51, 68, 81, 69, 66, 66, 81, 85, 65, 65, 52, 73, 66, 65, 81, 67, 106, 71, 105, 121, 98, 70, 119, 66, 99, 113, 82, 55, 117, 75, 71, 89, 51, 79, 114, 43, 68, 120, 122, 57, 76, 119, 119, 109, 103, 108, 83, 66, 100, 52, 57, 108, 90, 82, 78, 73, 43, 68, 84, 54, 57, 10, 105, 107, 117, 103, 100, 66, 47, 79, 69, 73, 75, 99, 100, 66, 111, 100, 102, 112, 103, 97, 51, 99, 115, 84, 83, 55, 77, 103, 82, 79, 83, 82, 54, 99, 122, 56, 102, 97, 88, 98, 97, 117, 88, 43, 53, 118, 51, 103, 84, 116, 50, 51, 65, 68, 113, 49, 99, 69, 109, 118, 56, 117, 88, 114, 10, 65, 118, 72, 82, 65, 111, 115, 90, 121, 53, 81, 54, 88, 107, 106, 69, 71, 66, 53, 89, 71, 86, 56, 101, 65, 108, 114, 119, 68, 80, 71, 120, 114, 97, 110, 99, 87, 89, 97, 76, 98, 117, 109, 82, 57, 89, 98, 75, 43, 114, 108, 109, 77, 54, 112, 90, 87, 56, 55, 105, 112, 120, 90, 122, 10, 82, 56, 115, 114, 122, 74, 109, 119, 78, 48, 106, 80, 52, 49, 90, 76, 57, 99, 56, 80, 68, 72, 73, 121, 104, 56, 98, 119, 82, 76, 116, 84, 99, 109, 49, 68, 57, 83, 90, 73, 109, 108, 74, 110, 116, 49, 105, 114, 47, 109, 100, 50, 99, 88, 106, 98, 68, 97, 74, 87, 70, 66, 77, 53, 10, 74, 68, 71, 70, 111, 113, 103, 67, 87, 106, 66, 72, 52, 100, 49, 81, 66, 55, 119, 67, 67, 90, 65, 65, 54, 50, 82, 106, 89, 74, 115, 87, 118, 73, 106, 74, 69, 117, 98, 83, 102, 90, 71, 76, 43, 84, 48, 121, 106, 87, 87, 48, 54, 88, 121, 120, 86, 51, 98, 113, 120, 98, 89, 111, 10, 79, 98, 56, 86, 90, 82, 122, 73, 57, 110, 101, 87, 97, 103, 113, 78, 100, 119, 118, 89, 107, 81, 115, 69, 106, 103, 102, 98, 75, 98, 89, 75, 55, 112, 50, 67, 78, 84, 85, 81, 10, 45, 45, 45, 45, 45, 69, 78, 68, 32, 67, 69, 82, 84, 73, 70, 73, 67, 65, 84, 69, 45, 45, 45, 45, 45, 10 };
};
